build: go
	go build shake.go
version:
	cat version.txt
tag:
	TAG=${RELEASE_TAG:-$(./shake version)}
	if [ -z ${TAG} ];then
		echo "RELEASE_TAG is empty"
		exit 1
	fi
	git tag ${TAG} | true
go:
	if [ -z `which go` ];then
		echo "can't go..."
		exit 1
	fi
goreleaser: go
	go get github.com/goreleaser/goreleaser
release: build goreleaser
	GITHUB_TOKEN=$(./shake decrypt) goreleaser --rm-dist
decrypt:
	openssl aes-256-cbc -d -in github_token.enc
# for test
hello: foo
	echo "hello"
foo:
	echo "foo"
list: dev
	ls .
dev:
	if [ ${DEV} ];then
		echo "dev"
	else
		echo "nondev"
	fi
way: list hello go
	:
seq: hello list way
	for i in `seq 3`
	do
		echo ${i}
	done
say:
	say "hello"
circ: circ
	:
